<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agente Gemini</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Esta configuración es crucial para que el dark mode funcione con la clase 'dark' en la etiqueta html
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">

    <!-- Contenedor principal del panel -->
    <div class="container mx-auto p-4 md:p-8 flex flex-col md:flex-row h-screen">
        
        <!-- Contenido principal (Chat e Historial) -->
        <div class="flex-1 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 flex flex-col mr-0 md:mr-6 mb-6 md:mb-0 transition-colors duration-300">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-blue-600 dark:text-blue-400">🤖 Agente Gemini</h1>
                <div class="flex items-center space-x-2">
                    <button id="guide-button" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 focus:outline-none hover:ring-2 ring-blue-500">
                        ❓
                    </button>
                    <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 focus:outline-none hover:ring-2 ring-blue-500">
                        <span id="theme-icon">🌙</span>
                    </button>
                </div>
            </div>
            
            <!-- Contenedor de la guía y el historial -->
            <div id="content-area" class="flex-1 overflow-y-auto scrollbar-hide mb-6 p-2 space-y-4">
                <div id="guide-section">
                    <h2 class="text-2xl font-semibold mb-4">Bienvenido al Agente Gemini</h2>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">Escribe tu comando para empezar a interactuar con el agente.</p>
                </div>

                <div id="history" class="space-y-6"></div>
                <div id="loading-indicator" class="hidden text-center text-blue-500 italic">Cargando...</div>
            </div>

            <!-- Formulario de entrada -->
            <form id="commandForm" class="flex mt-auto">
                <input type="text" id="user_input" class="flex-1 p-3 rounded-l-full border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100" placeholder="Escribe tu comando aquí" required>
                <button type="submit" class="p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-r-full focus:outline-none focus:ring-2 ring-blue-500 transition-colors">
                    Enviar
                </button>
            </form>
        </div>

<!-- Sección de Notificaciones -->
        <div id="notifications-section">
            <h3 class="font-semibold text-lg text-gray-700 dark:text-gray-300 mb-2">🔔 Notificaciones</h3>
            <div class="space-y-2 mb-4">
                <button onclick="configureNotifications()" 
                        class="block w-full text-center p-2 bg-purple-500 hover:bg-purple-600 text-white font-semibold rounded-lg transition-colors">
                    ⚙️ Configurar
                </button>
                <button onclick="testNotifications()" 
                        class="block w-full text-center p-2 bg-gray-500 hover:bg-gray-600 text-white font-semibold rounded-lg transition-colors">
                    🧪 Probar
                </button>
                <div id="notification-status" class="text-xs text-gray-500 dark:text-gray-400 text-center">
                    Estado: Iniciando...
                </div>
            </div>
        </div>

<!-- Sección de Documentos -->
<div class="mb-6">
    <button id="document-toggle" onclick="toggleDocumentSection()" 
            class="w-full text-left p-3 bg-purple-500 hover:bg-purple-600 text-white font-semibold rounded-lg transition-colors cursor-pointer">
        📄 Documentos ▶
    </button>
    
    <div id="document-section" class="hidden mt-4 space-y-4">
        <!-- Ayuda rápida -->
        <div class="bg-purple-50 dark:bg-purple-900 p-3 rounded-lg">
            <div class="text-sm text-purple-700 dark:text-purple-300 mb-2">
                <strong>💡 Sistema de Rellenado de Documentos</strong><br>
                Perfecto para solicitudes de ayudas y subvenciones
            </div>
            <div class="flex flex-wrap gap-2">
                <button onclick="showDocumentHelp()" 
                        class="text-xs px-2 py-1 bg-purple-200 hover:bg-purple-300 dark:bg-purple-700 dark:hover:bg-purple-600 text-purple-800 dark:text-purple-200 rounded transition-colors">
                    📖 Ayuda
                </button>
                <button onclick="startDocumentWalkthrough()" 
                        class="text-xs px-2 py-1 bg-purple-200 hover:bg-purple-300 dark:bg-purple-700 dark:hover:bg-purple-600 text-purple-800 dark:text-purple-200 rounded transition-colors">
                    🚀 Tutorial
                </button>
                <button onclick="listTemplates()" 
                        class="text-xs px-2 py-1 bg-purple-200 hover:bg-purple-300 dark:bg-purple-700 dark:hover:bg-purple-600 text-purple-800 dark:text-purple-200 rounded transition-colors">
                    📄 Ver plantillas
                </button>
            </div>
        </div>

        <!-- Subir Plantillas -->
        <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg">
            <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-3">📄 Plantillas (.docx, .txt, .pdf)</h4>
            
            <div class="mb-3">
                <input type="file" id="template-file-input" 
                       accept=".docx,.txt,.pdf" 
                       class="block w-full text-sm text-gray-500 dark:text-gray-400
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-full file:border-0
                              file:text-sm file:font-semibold
                              file:bg-blue-50 file:text-blue-700
                              hover:file:bg-blue-100
                              dark:file:bg-blue-800 dark:file:text-blue-200
                              dark:hover:file:bg-blue-700">
            </div>
            
            <button onclick="uploadTemplate()" 
                    class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium">
                📤 Subir Plantilla
            </button>
            
            <div id="templates-list" class="mt-3">
                <!-- Las plantillas se cargan dinámicamente -->
            </div>
        </div>

        <!-- Subir Datos -->
        <div class="bg-green-50 dark:bg-green-900 p-4 rounded-lg">
            <h4 class="font-semibold text-green-800 dark:text-green-200 mb-3">📊 Datos (.json, .csv, .xlsx)</h4>
            
            <div class="mb-3">
                <input type="file" id="data-file-input" 
                       accept=".json,.csv,.xlsx,.txt" 
                       class="block w-full text-sm text-gray-500 dark:text-gray-400
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-full file:border-0
                              file:text-sm file:font-semibold
                              file:bg-green-50 file:text-green-700
                              hover:file:bg-green-100
                              dark:file:bg-green-800 dark:file:text-green-200
                              dark:hover:file:bg-green-700">
            </div>
            
            <button onclick="uploadDataFile()" 
                    class="w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors font-medium">
                📤 Subir Datos
            </button>
            <div id="data-files-list" class="mt-3">
                <!-- Los archivos de datos se cargan dinámicamente -->
            </div>
        </div>

        <!-- Documentos Generados -->
        <div class="bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg">
            <h4 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-3">📁 Documentos Generados</h4>

            <div id="output-files-list" class="mt-3">
                <!-- Los documentos generados se cargan dinámicamente -->
            </div>
            
            <div class="text-xs text-yellow-600 dark:text-yellow-400 mt-2 italic">
                💡 Los documentos rellenados aparecen aquí automáticamente
            </div>
        </div>

        <!-- Comandos Rápidos -->
        <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
            <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-3">⚡ Comandos Rápidos</h4>
            
            <div class="grid grid-cols-2 gap-2 text-xs">
                <button onclick="input.value='listar plantillas'; form.dispatchEvent(new Event('submit'));"
                        class="px-2 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded transition-colors">
                    📄 Listar plantillas
                </button>
                
                <button onclick="input.value='listar datos'; form.dispatchEvent(new Event('submit'));"
                        class="px-2 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded transition-colors">
                    📊 Listar datos
                </button>
            </div>
            
            <div class="mt-3 text-xs text-gray-600 dark:text-gray-400">
                <strong>📝 Ejemplos de comandos:</strong><br>
                • <code>analizar: mi_plantilla.docx</code><br>
                • <code>crear ejemplo datos: mi_plantilla.docx</code><br>
                • <code>rellenar: plantilla.docx con datos.json</code>
            </div>
        </div>

        <!-- Guía de Marcadores -->
        <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg">
            <h4 class="font-semibold text-indigo-800 dark:text-indigo-200 mb-3">🔤 Guía de Marcadores en Plantillas</h4>
            
            <div class="text-xs text-indigo-700 dark:text-indigo-300 space-y-1">
                <div><code>{{nombre}}</code> → Será reemplazado por el valor de "nombre"</div>
                <div><code>{{empresa}}</code> → Será reemplazado por el valor de "empresa"</div>
                <div><code>{{fecha}}</code> → Se rellena automáticamente con la fecha actual</div>
                <div><code>[campo]</code> → También funciona con corchetes</div>
                <div><code>_campo_</code> → También funciona con guiones bajos</div>
            </div>
            
            <div class="mt-2 text-xs text-indigo-600 dark:text-indigo-400 italic">
                💡 Tip: Usa nombres descriptivos como {{nombre_empresa}}, {{direccion_fiscal}}, {{importe_solicitado}}
            </div>
        </div>

        <!-- Ejemplos de Uso -->
        <div class="bg-teal-50 dark:bg-teal-900 p-4 rounded-lg">
            <h4 class="font-semibold text-teal-800 dark:text-teal-200 mb-3">🎯 Casos de Uso Típicos</h4>
            
            <div class="text-xs text-teal-700 dark:text-teal-300 space-y-2">
                <div class="flex items-start">
                    <span class="mr-2">📋</span>
                    <div>
                        <strong>Solicitudes de Ayudas:</strong><br>
                        Plantilla con {{empresa}}, {{proyecto}}, {{importe}} → Genera solicitudes personalizadas
                    </div>
                </div>
                
                <div class="flex items-start">
                    <span class="mr-2">📄</span>
                    <div>
                        <strong>Contratos Repetitivos:</strong><br>
                        Plantilla con {{cliente}}, {{servicio}}, {{precio}} → Contratos automáticos
                    </div>
                </div>
                
                <div class="flex items-start">
                    <span class="mr-2">📊</span>
                    <div>
                        <strong>Informes Regulares:</strong><br>
                        Plantilla con {{periodo}}, {{datos}}, {{conclusiones}} → Informes mensuales
                    </div>
                </div>
            </div>
        </div>
<!-- Sección de Espectros RMN -->
<div class="mb-6">
    <button id="rmn-toggle" onclick="toggleRMNSection()" 
            class="w-full text-left p-3 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg transition-colors cursor-pointer">
        🧪 Espectros RMN ▶
    </button>

    <div id="rmn-section" class="hidden mt-4 space-y-4">
        <!-- Ayuda rápida RMN -->
        <div class="bg-green-50 dark:bg-green-900 p-3 rounded-lg">
            <div class="text-sm text-green-700 dark:text-green-300 mb-2">
                <strong>🔬 Limpiador de Espectros RMN</strong><br>
                Elimina ruido y mejora la calidad de tus espectros
            </div>
            <div class="flex flex-wrap gap-2">
                <button onclick="showRMNHelp()" 
                        class="text-xs px-2 py-1 bg-green-200 hover:bg-green-300 dark:bg-green-700 dark:hover:bg-green-600 text-green-800 dark:text-green-200 rounded transition-colors">
                    📖 Ayuda
                </button>
                <button onclick="showRMNMethods()" 
                        class="text-xs px-2 py-1 bg-green-200 hover:bg-green-300 dark:bg-green-700 dark:hover:bg-green-600 text-green-800 dark:text-green-200 rounded transition-colors">
                    🔧 Métodos
                </button>
                <button onclick="listSpectra()" 
                        class="text-xs px-2 py-1 bg-green-200 hover:bg-green-300 dark:bg-green-700 dark:hover:bg-green-600 text-green-800 dark:text-green-200 rounded transition-colors">
                    📊 Ver espectros
                </button>
            </div>
        </div>

        <!-- Subir Espectros -->
        <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg">
            <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-3">📊 Subir Espectros (.csv, .txt, .dat, .json)</h4>

            <div class="mb-3">
                <input type="file" id="spectrum-file-input" 
                       accept=".csv,.txt,.dat,.asc,.json" 
                       class="block w-full text-sm text-gray-500 dark:text-gray-400
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-full file:border-0
                              file:text-sm file:font-semibold
                              file:bg-blue-50 file:text-blue-700
                              hover:file:bg-blue-100
                              dark:file:bg-blue-800 dark:file:text-blue-200
                              dark:hover:file:bg-blue-700">
            </div>

            <button onclick="uploadSpectrum()" 
                    class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium">
                📤 Subir Espectro
            </button>

            <div class="text-xs text-blue-600 dark:text-blue-400 mt-2 italic">
                💡 Formato esperado: dos columnas (ppm/frecuencia, intensidad)
            </div>

            <div id="spectra-list" class="mt-3">
                <!-- Los espectros se cargan dinámicamente -->
            </div>
        </div>

        <!-- Métodos de Limpieza -->
        <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg">
            <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-3">🔧 Métodos de Limpieza</h4>

            <div class="grid grid-cols-2 gap-2 text-xs mb-3">
                <button onclick="quickCleanAuto()" 
                        class="px-2 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors font-semibold">
                    🤖 Auto
                </button>
                <button onclick="quickCleanSavgol()" 
                        class="px-2 py-1 bg-purple-200 hover:bg-purple-300 dark:bg-purple-700 dark:hover:bg-purple-600 text-purple-800 dark:text-purple-200 rounded transition-colors">
                    📈 Savgol
                </button>
                <button onclick="quickCleanGaussian()" 
                        class="px-2 py-1 bg-purple-200 hover:bg-purple-300 dark:bg-purple-700 dark:hover:bg-purple-600 text-purple-800 dark:text-purple-200 rounded transition-colors">
                    🌊 Gaussiano
                </button>
                <button onclick="quickCleanMedian()" 
                        class="px-2 py-1 bg-purple-200 hover:bg-purple-300 dark:bg-purple-700 dark:hover:bg-purple-600 text-purple-800 dark:text-purple-200 rounded transition-colors">
                    🎯 Mediana
                </button>
            </div>

            <div class="text-xs text-purple-700 dark:text-purple-300 space-y-1">
                <div><strong>Auto:</strong> Selecciona el mejor método automáticamente</div>
                <div><strong>Savgol:</strong> Preserva la forma de los picos</div>
                <div><strong>Gaussiano:</strong> Suavizado general efectivo</div>
                <div><strong>Mediana:</strong> Elimina picos de ruido</div>
            </div>
        </div>

        <!-- Comandos Rápidos RMN -->
        <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
            <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-3">⚡ Comandos Rápidos RMN</h4>

            <div class="grid grid-cols-2 gap-2 text-xs">
                <button onclick="executeRMNCommand('listar espectros')"
                        class="px-2 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded transition-colors">
                    📊 Listar espectros
                </button>
                <button onclick="executeRMNCommand('métodos')"
                        class="px-2 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded transition-colors">
                    🔧 Ver métodos
                </button>
            </div>

            <div class="mt-3 text-xs text-gray-600 dark:text-gray-400">
                <strong>📝 Ejemplos de comandos:</strong><br>
                • <code>analizar: mi_espectro.csv</code><br>
                • <code>limpiar auto: mi_espectro.csv</code><br>
                • <code>comparar: mi_espectro.csv</code><br>
                • <code>exportar: mi_espectro.csv formato json</code>
            </div>
        </div>

        <!-- Casos de Uso -->
        <div class="bg-teal-50 dark:bg-teal-900 p-4 rounded-lg">
            <h4 class="font-semibold text-teal-800 dark:text-teal-200 mb-3">🎯 Casos de Uso</h4>

            <div class="text-xs text-teal-700 dark:text-teal-300 space-y-2">
                <div class="flex items-start">
                    <span class="mr-2">🔬</span>
                    <div>
                        <strong>Análisis Cuantitativo:</strong><br>
                        Mejora la precisión en la integración de picos
                    </div>
                </div>

                <div class="flex items-start">
                    <span class="mr-2">🧬</span>
                    <div>
                        <strong>Identificación de Compuestos:</strong><br>
                        Elimina ruido para mejor identificación de señales
                    </div>
                </div>

                <div class="flex items-start">
                    <span class="mr-2">📊</span>
                    <div>
                        <strong>Machine Learning:</strong><br>
                        Prepara datos limpios para algoritmos ML
                    </div>
                </div>

                <div class="flex items-start">
                    <span class="mr-2">📄</span>
                    <div>
                        <strong>Publicaciones:</strong><br>
                        Espectros de alta calidad para artículos científicos
                    </div>
                </div>
            </div>
        </div>

        <!-- Estado del Sistema RMN -->
        <div class="bg-green-50 dark:bg-green-900 p-3 rounded-lg">
            <div class="text-xs text-green-700 dark:text-green-300 text-center">
                <strong>📊 Estado RMN</strong><br>
                <span id="rmn-stats">Espectros: 0 | Limpios: 0 | Gráficos: 0</span>
            </div>
        </div>
    </div>
</div>


        <!-- Estadísticas -->
        <div class="bg-purple-50 dark:bg-purple-900 p-3 rounded-lg">
            <div class="text-xs text-purple-700 dark:text-purple-300 text-center">
                <strong>📊 Estado del Sistema</strong><br>
                <span id="document-stats">Plantillas: 0 | Datos: 0 | Generados: 0</span>
            </div>
        </div>
    </div>
</div>       

<!-- Panel lateral para archivos -->
        <div class="w-full md:w-80 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 flex flex-col transition-colors duration-300">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-200">💾 Archivos Guardados</h2>
            <div id="files-list" class="flex-1 overflow-y-auto space-y-4 scrollbar-hide">
                
                <!-- Sección de Código -->
                <div id="code-files-container">
                    <h3 class="font-semibold text-lg text-gray-700 dark:text-gray-300 mb-2">💻 Código</h3>
                    <div id="code-files-list" class="space-y-2 mb-4"></div>
                </div>
                
                <!-- Sección de Notas -->
                <div id="notes-section">
                    <h3 class="font-semibold text-lg text-gray-700 dark:text-gray-300 mb-2">📝 Notas</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400 italic text-center mb-2">Cargando...</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Modal Unificada de Guía y Palabras Clave -->
<div id="guide-keywords-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 z-50 max-w-4xl w-full max-h-[90vh] overflow-y-auto scrollbar-hide">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">📘 Guía de Uso y Palabras Clave del Agente</h2>
            <button id="close-guide-keywords-modal" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <!-- Tabs -->
        <div class="mb-4">
            <button class="tab-button px-4 py-2 bg-blue-100 dark:bg-blue-700 rounded-l-xl focus:outline-none" data-tab="tools">Herramientas</button>
            <button class="tab-button px-4 py-2 bg-gray-100 dark:bg-gray-600 rounded-r-xl focus:outline-none" data-tab="keywords">Palabras Clave</button>
        </div>

        <!-- Contenido de Tabs -->
        <div id="tab-tools" class="tab-content">
            <!-- Note -->
            <div class="p-4 bg-yellow-100 dark:bg-yellow-800 rounded-xl mb-4">
                <h3 class="font-bold text-yellow-800 dark:text-yellow-100 text-lg">📝 Note (Notas)</h3>
                <p class="mt-2">Maneja tus notas personales. Se guardan automáticamente con fecha y hora.</p>
                <ul class="mt-2 list-disc list-inside text-sm">
                    <li><strong>Guardar nota:</strong> <code>guardar: tu nota aquí</code></li>
                    <li><strong>Ver todas:</strong> <code>leer</code></li>
                    <li><strong>Buscar:</strong> <code>buscar: término</code></li>
                    <li><strong>Contar:</strong> <code>contar</code></li>
                    <li><strong>Borrar todas:</strong> <code>borrar</code></li>
                    <li><strong>Descargar:</strong> <code>descargar</code></li>
                </ul>
            </div>

            <!-- Save Code -->
            <div class="p-4 bg-green-100 dark:bg-green-800 rounded-xl mb-4">
                <h3 class="font-bold text-green-800 dark:text-green-100 text-lg">💻 Save Code (Guardar Código)</h3>
                <p class="mt-2">Guarda snippets de código en la carpeta de archivos.</p>
                <ul class="mt-2 list-disc list-inside text-sm">
                    <li><strong>Formato:</strong> <code>nombre_archivo||contenido_del_codigo</code></li>
                    <li><strong>Ejemplo:</strong> <code>script.py||print("Hola Mundo")</code></li>
                    <li><strong>Otro ejemplo:</strong> <code>calculadora.py||def suma(a,b): return a+b</code></li>
                </ul>
            </div>

            <!-- Code Gen -->
            <div class="p-4 bg-purple-100 dark:bg-purple-800 rounded-xl mb-4">
                <h3 class="font-bold text-purple-800 dark:text-purple-100 text-lg">⚙️ Code Gen (Generar Código)</h3>
                <p class="mt-2">Genera código automáticamente usando IA y lo guarda automáticamente.</p>
                <ul class="mt-2 list-disc list-inside text-sm">
                    <li><strong>Formato básico:</strong> <code>generar: un script en Python que diga hola mundo</code></li>
                    <li><strong>Con nombre personalizado:</strong> <code>mi_script.py||generar un script que haga una calculadora</code></li>
                    <li><strong>Solo descripción:</strong> <code>crear una función que sume números</code></li>
                </ul>
            </div>

            <!-- Calculator -->
            <div class="p-4 bg-indigo-100 dark:bg-indigo-800 rounded-xl mb-4">
                <h3 class="font-bold text-indigo-800 dark:text-indigo-100 text-lg">🧮 Calculator (Calculadora)</h3>
                <p class="mt-2">Evalúa expresiones matemáticas complejas.</p>
                <ul class="mt-2 list-disc list-inside text-sm">
                    <li><strong>Ejemplo:</strong> <code>2 + 2 * (3 - 1)</code> devuelve <code>6</code></li>
                    <li><strong>Otro ejemplo:</strong> <code>(100 / 2) ** 2</code> devuelve <code>2500.0</code></li>
                </ul>
            </div>

            <!-- Web Search -->
            <div class="p-4 bg-blue-100 dark:bg-blue-800 rounded-xl mb-4">
                <h3 class="font-bold text-blue-800 dark:text-blue-100 text-lg">🔍 Web Search (Búsqueda en la web)</h3>
                <p class="mt-2">Busca en internet y devuelve los 5 primeros resultados.</p>
                <ul class="mt-2 list-disc list-inside text-sm">
                    <li><strong>Ejemplo:</strong> <code>buscar noticias de inteligencia artificial</code></li>
                    <li><strong>Otro ejemplo:</strong> <code>buscar patentes sobre energía solar</code></li>
                </ul>
            </div>

            <!-- Web Open -->
            <div class="p-4 bg-red-100 dark:bg-red-800 rounded-xl mb-4">
                <h3 class="font-bold text-red-800 dark:text-red-100 text-lg">🌐 Web Open (Abrir Enlaces)</h3>
                <p class="mt-2">Abre una URL directamente en tu navegador.</p>
                <ul class="mt-2 list-disc list-inside text-sm">
                    <li><strong>Ejemplo:</strong> <code>https://www.wikipedia.org</code></li>
                    <li><strong>Otro ejemplo:</strong> <code>wikipedia.org</code> (agrega https automáticamente)</li>
                </ul>
            </div>
        </div>

        <div id="tab-keywords" class="tab-content hidden">
            <!-- Código -->
            <div class="mb-4">
                <h3 class="font-semibold text-blue-700 dark:text-blue-300">💻 Generación de Código</h3>
                <p class="mt-1 font-mono bg-gray-100 dark:bg-gray-700 p-2 rounded-lg overflow-x-auto">
                    generar, genera, crear, crea, escribir, escribe, codigo, código, script, programa, función, funcion, algoritmo, clase, app, aplicación, aplicacion
                </p>
            </div>

            <!-- Notificaciones -->
            <div class="mb-4">
                <h3 class="font-semibold text-green-700 dark:text-green-300">🔔 Notificaciones</h3>
                <p class="mt-1 font-mono bg-gray-100 dark:bg-gray-700 p-2 rounded-lg overflow-x-auto">
                    listar, listar 10, listar 20, listar papers, listar patentes, listar patents, ver, mostrar, ver recientes, últimas, últimos, recientes, resumen, desglose, borrar, eliminar, borrar papers, eliminar papers, borrar todo, eliminar todo, limpiar, reset, clear, papers, patentes, emails, notificaciones, tipo, tipos, ID, id, identificador, ref, referencia, gestionar, administrar, control, verificar, consultar, notificacion, notificación, alerta, avisar, aviso, email, correo, patente, paper, científico, monitoreo, notificar, activar, keywords, categories, status, estado, test, probar
                </p>
            </div>

            <!-- Documentos -->
            <div class="mb-4">
                <h3 class="font-semibold text-purple-700 dark:text-purple-300">📄 Documentos</h3>
                <p class="mt-1 font-mono bg-gray-100 dark:bg-gray-700 p-2 rounded-lg overflow-x-auto">
                    plantilla, rellenar, documento, formulario, listar plantillas, listar datos, analizar, crear ejemplo, ayuda, subvencion, subvención, document_filler, plantillas, datos, rellenar:
                </p>
            </div>
            <!-- Espectros RMN -->
            <div class="mb-4">
                <h3 class="font-semibold text-green-700 dark:text-green-300">🧪 Espectros RMN</h3>
                <p class="mt-1 font-mono bg-gray-100 dark:bg-gray-700 p-2 rounded-lg overflow-x-auto">
                    rmn, espectro, espectros, resonancia magnética, ruido, limpiar espectro, filtrar, savgol, gaussian, mediana, wiener, línea base, snr, ppm, intensidad, picos, analizar espectro, limpiar auto, comparar espectro, exportar espectro, nmr, spectrum, noise, baseline, peaks, listar espectros
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    const guideKeywordsModal = document.getElementById("guide-keywords-modal");
    const guideButton = document.getElementById("guide-button");
    const closeGuideKeywordsButton = document.getElementById("close-guide-keywords-modal");

    guideButton.addEventListener("click", () => guideKeywordsModal.classList.remove("hidden"));
    closeGuideKeywordsButton.addEventListener("click", () => guideKeywordsModal.classList.add("hidden"));
    guideKeywordsModal.addEventListener("click", (e) => {
        if(e.target === guideKeywordsModal) guideKeywordsModal.classList.add("hidden");
    });

    // Tabs
    const tabButtons = document.querySelectorAll(".tab-button");
    const tabContents = document.querySelectorAll(".tab-content");
    tabButtons.forEach(btn => {
        btn.addEventListener("click", () => {
            tabContents.forEach(tc => tc.classList.add("hidden"));
            tabButtons.forEach(b => b.classList.remove("bg-blue-100","dark:bg-blue-700"));
            tabButtons.forEach(b => b.classList.add("bg-gray-100","dark:bg-gray-600"));
            document.getElementById("tab-" + btn.dataset.tab).classList.remove("hidden");
            btn.classList.remove("bg-gray-100","dark:bg-gray-600");
            btn.classList.add("bg-blue-100","dark:bg-blue-700");
        });
    });
</script>

    <script src="/static/script.js"></script>
    <script type="module" src="/static/js/document.js"></script>
    <script src="/static/js/rmn.js"></script>
</body>
</html>
